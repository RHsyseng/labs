<!doctype html><html>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>OpenShift 4.7 on AWS - Labs@Sysdeseng</title>
<meta name=description content="Labs to play with Edge and Telco 5G sustaining technologies">
<meta name=generator content="Hugo 0.92.1">
<link href=https://pages.sysdeseng.com/labs/index.xml rel=alternate type=application/rss+xml>
<link rel=canonical href=https://pages.sysdeseng.com/labs/ocp/ipi/openshift-4.7-aws/>
<link rel=stylesheet href=https://pages.sysdeseng.com/labs/css/theme.min.css>
<script src=https://use.fontawesome.com/releases/v5.0.6/js/all.js></script>
<link rel=stylesheet href=https://pages.sysdeseng.com/labs/css/chroma.min.css>
<script src=https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js></script>
<script src=https://pages.sysdeseng.com/labs/js/bundle.js></script><style>:root{--custom-font-color:#ffffff;--custom-background-color:#cc0000}</style>
<meta property="og:title" content="OpenShift 4.7 on AWS">
<meta property="og:description" content="reference:
Lab Folder: N/A (There is not Lab folder created for this one because we&rsquo;re following the official cloud doc to get the binary and installing directly)
URL guides followed:  GCP: https://www.openshift.com/blog/ocp-4.6-install-on-gcp-cloud-the-smooth-experience AWS: https://docs.openshift.com/container-platform/4.7/installing/installing_aws/installing-aws-default.html  Download IPI installer. There are two ways:
 Mirror: https://mirror.openshift.com/pub/openshift-v4/clients/ocp/stable/ Official site: https://cloud.redhat.com/openshift/create/cloud and https://cloud.redhat.com/openshift/install/aws  Procedure:
 Download the IPI installer from the web. Download the pull secret Install oc client in your path if you didn‚Äôt install it before  Configure DNS zone When IPI installer is run, one of the interactive steps looks for DNS name to use in the cluster.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://pages.sysdeseng.com/labs/ocp/ipi/openshift-4.7-aws/"><meta property="og:image" content="https://pages.sysdeseng.com/android-chrome-192x192.png"><meta property="article:section" content="OCP">
<meta property="og:site_name" content="Labs index">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://pages.sysdeseng.com/android-chrome-192x192.png">
<meta name=twitter:title content="OpenShift 4.7 on AWS">
<meta name=twitter:description content="reference:
Lab Folder: N/A (There is not Lab folder created for this one because we&rsquo;re following the official cloud doc to get the binary and installing directly)
URL guides followed:  GCP: https://www.openshift.com/blog/ocp-4.6-install-on-gcp-cloud-the-smooth-experience AWS: https://docs.openshift.com/container-platform/4.7/installing/installing_aws/installing-aws-default.html  Download IPI installer. There are two ways:
 Mirror: https://mirror.openshift.com/pub/openshift-v4/clients/ocp/stable/ Official site: https://cloud.redhat.com/openshift/create/cloud and https://cloud.redhat.com/openshift/install/aws  Procedure:
 Download the IPI installer from the web. Download the pull secret Install oc client in your path if you didn‚Äôt install it before  Configure DNS zone When IPI installer is run, one of the interactive steps looks for DNS name to use in the cluster.">
<meta itemprop=name content="OpenShift 4.7 on AWS">
<meta itemprop=description content="reference:
Lab Folder: N/A (There is not Lab folder created for this one because we&rsquo;re following the official cloud doc to get the binary and installing directly)
URL guides followed:  GCP: https://www.openshift.com/blog/ocp-4.6-install-on-gcp-cloud-the-smooth-experience AWS: https://docs.openshift.com/container-platform/4.7/installing/installing_aws/installing-aws-default.html  Download IPI installer. There are two ways:
 Mirror: https://mirror.openshift.com/pub/openshift-v4/clients/ocp/stable/ Official site: https://cloud.redhat.com/openshift/create/cloud and https://cloud.redhat.com/openshift/install/aws  Procedure:
 Download the IPI installer from the web. Download the pull secret Install oc client in your path if you didn‚Äôt install it before  Configure DNS zone When IPI installer is run, one of the interactive steps looks for DNS name to use in the cluster.">
<meta itemprop=wordCount content="531"><meta itemprop=image content="https://pages.sysdeseng.com/android-chrome-192x192.png">
<meta itemprop=keywords content="OpenShift,IPI,labs,AWS,"></head>
<body><div class=container><header>
<h1>Labs@Sysdeseng</h1>
<p class=description>Labs to play with Edge and Telco 5G sustaining technologies</p>
</header>
<div class=global-menu>
<nav>
<ul>
<li><a href=/labs/search>üîçsearch</a></li></ul>
</nav>
</div>
<div class=content-container>
<main><h1>OpenShift 4.7 on AWS</h1>
<aside class=table_of_contents>
<h5>Table of Contents</h5><nav id=TableOfContents>
<ul>
<li>
<ul>
<li><a href=#download-ipi-installer>Download IPI installer.</a></li>
<li><a href=#configure-dns-zone>Configure DNS zone</a></li>
<li><a href=#launch-installation>Launch installation</a></li>
</ul>
</li>
</ul>
</nav></aside>
<p>reference:</p>
<p>Lab Folder: N/A (There is not Lab folder created for this one because we&rsquo;re following the official cloud doc to get the binary and installing directly)</p>
<h1 id=url-guides-followed>URL guides followed:</h1>
<ul>
<li>GCP: <a href=https://www.openshift.com/blog/ocp-4.6-install-on-gcp-cloud-the-smooth-experience>https://www.openshift.com/blog/ocp-4.6-install-on-gcp-cloud-the-smooth-experience</a></li>
<li>AWS: <a href=https://docs.openshift.com/container-platform/4.7/installing/installing_aws/installing-aws-default.html>https://docs.openshift.com/container-platform/4.7/installing/installing_aws/installing-aws-default.html</a></li>
</ul>
<h3 id=download-ipi-installer>Download IPI installer.</h3>
<p>There are two ways:</p>
<ul>
<li>Mirror: <a href=https://mirror.openshift.com/pub/openshift-v4/clients/ocp/stable/>https://mirror.openshift.com/pub/openshift-v4/clients/ocp/stable/</a></li>
<li>Official site: <a href=https://cloud.redhat.com/openshift/create/cloud>https://cloud.redhat.com/openshift/create/cloud</a> and <a href=https://cloud.redhat.com/openshift/install/aws>https://cloud.redhat.com/openshift/install/aws</a></li>
</ul>
<p>Procedure:</p>
<ul>
<li>Download the IPI installer from the web.</li>
<li>Download the pull secret</li>
<li>Install <code>oc</code> client in your path if you didn‚Äôt install it before</li>
</ul>
<h3 id=configure-dns-zone>Configure DNS zone</h3>
<p>When IPI installer is run, one of the interactive steps looks for DNS name to use in the cluster. This search is performed in Route53 within the account that is used with the credentials provided. Hence it is required to create a DNS zone to use in the installation. Below are the steps required to create this zone.</p>
<ol>
<li><strong>Create subdomain Zone:</strong> Open the AWS Console and go to <code>Services > Route53 > Hosted zones</code>. In there, click on <strong>Create hosted zone</strong> and follow the form to create your lab domain. For this example we are going to use <code>mylab.sysdeseng.com</code> domain name. Click on <strong>Create zone</strong> and, once the zone has been created, copy the name of the <code>NS</code> servers for your new zone, will be required later.</li>
</ol>
<p><img src=/labs/img/create-route53-zone1.png alt="Create Route53 Zone"></p>
<ol start=2>
<li><strong>Add subdomain <code>NS</code> entry to main zone:</strong> As the zone created is a subdomain from the main zone <code>sysdeseng.com</code>, it is required to add a <code>NS</code> entry in the main zone to point to the DNS servers of the new subdomain zone. Just open the <code>sysdeseng.com</code> zone in the Route53 console and click on <strong>Create record</strong>. In the opened form fill in with the following values:
_ <strong>Record name:</strong> <code>mylab</code>
_ <strong>Record type:</strong> <code>NS - Name servers for a hosted zone</code>
_ <strong>Value:</strong> (paste your subdomain zone DNS server list)
_ <strong>TTL:</strong> <code>300</code>
Click on <strong>Create records</strong> when finish.</li>
</ol>
<p><img src=/labs/img/create-route53-zone2.png alt="Add Record "></p>
<ol start=3>
<li><strong>Validation:</strong> Once all the previous steps are finished try to resolve the new zone with the Google DNS. In order to do that open a console and use <code>dig</code> command to perform a DNS query. The output should be something similar to below.</li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ dig @8.8.8.8 ns mylab.sysdeseng.com

; &lt;&lt;&gt;&gt; DiG 9.16.1- &lt;&lt;&gt;&gt; ns mylab.sysdeseng.com
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER<span style=color:#e6db74>&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span style=color:#ae81ff>60678</span>
;; flags: qr rd ra; QUERY: 1, ANSWER: 4, AUTHORITY: 0, ADDITIONAL: <span style=color:#ae81ff>1</span>

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: <span style=color:#ae81ff>65494</span>
;; QUESTION SECTION:
;mylab.sysdeseng.com.		IN	NS

;; ANSWER SECTION:
mylab.sysdeseng.com.	21599	IN	NS	ns-1269.awsdns-30.org.
mylab.sysdeseng.com.	21599	IN	NS	ns-1646.awsdns-13.co.uk.
mylab.sysdeseng.com.	21599	IN	NS	ns-479.awsdns-59.com.
mylab.sysdeseng.com.	21599	IN	NS	ns-961.awsdns-56.net.

;; Query time: <span style=color:#ae81ff>44</span> msec
;; SERVER: 127.0.0.53#53<span style=color:#f92672>(</span>127.0.0.53<span style=color:#f92672>)</span>
;; WHEN: vie ago <span style=color:#ae81ff>06</span> 13:37:51 CEST <span style=color:#ae81ff>2021</span>
;; MSG SIZE  rcvd: <span style=color:#ae81ff>188</span>
</code></pre></div><h3 id=launch-installation>Launch installation</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$./openshift-install create cluster --log-level<span style=color:#f92672>=</span>info
</code></pre></div><p>Once bootstrap VM has been created and running, you could get access using the <code>ssh</code> provided in the installer using the user <code>core</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ ssh -i .ssh/id_rsa_common core@35.180.38.188
Red Hat Enterprise Linux CoreOS 47.83.202102090044-0
Part of OpenShift 4.7, RHCOS is a Kubernetes native operating system
managed by the Machine Config Operator <span style=color:#f92672>(</span><span style=color:#e6db74>`</span>clusteroperator/machine-config<span style=color:#e6db74>`</span><span style=color:#f92672>)</span>.
</code></pre></div><p>Here, you could follow the process with:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ journalctl -fu bootkube
</code></pre></div><p>Wait until finish:</p>
<p>After installation, if you want to destroy cluster to avoid unnecessary costs:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$./openshift-install destroy cluster
</code></pre></div><div class=edit-meta>
<br></div><nav class=pagination><a class="nav nav-prev" href=https://pages.sysdeseng.com/labs/ocp/ipi/kcli-ipi-withoutmetal3-ipv4con/ title="kcli without Metal¬≥ and IPv4 connected"><i class="fas fa-arrow-left" aria-hidden=true></i>&nbsp;Prev - kcli without Metal¬≥ and IPv4 connected</a>
<a class="nav nav-next" href=https://pages.sysdeseng.com/labs/ocp/upi/ title="User Provisioned Infrastructure (UPI)">Next - User Provisioned Infrastructure (UPI) <i class="fas fa-arrow-right" aria-hidden=true></i></a>
</nav><footer><p class=powered>Powered by <a href=https://gohugo.io>Hugo</a>. Theme by <a href=https://themes.gohugo.io/hugo-theme-techdoc/>TechDoc</a>. Designed by <a href=https://github.com/thingsym/hugo-theme-techdoc>Thingsym</a>.</p>
</footer>
</main>
<div class=sidebar>
<nav class=slide-menu>
<ul>
<li><a href=https://pages.sysdeseng.com/labs>Home</a></li>
<li class="parent has-sub-menu"><a href=https://pages.sysdeseng.com/labs/ocp/>Labs to install an OpenShift cluster<span class="mark opened">-</span></a>
<ul class=sub-menu>
<li class="parent has-sub-menu"><a href=https://pages.sysdeseng.com/labs/ocp/ipi/>Installer Provisioned Infrastructure (IPI)<span class="mark opened">-</span></a>
<ul class=sub-menu>
<li><a href=https://pages.sysdeseng.com/labs/ocp/ipi/kcli-ipi-metal3-ipv4con/>kcli with Metal¬≥ and IPv4 connected</a></li>
<li><a href=https://pages.sysdeseng.com/labs/ocp/ipi/kcli-ipi-metal3-ipv6disc/>kcli with Metal¬≥ and IPv6 disconnected</a></li>
<li><a href=https://pages.sysdeseng.com/labs/ocp/ipi/kcli-ipi-withoutmetal3-ipv4con/>kcli without Metal¬≥ and IPv4 connected</a></li>
<li class=active><a href=https://pages.sysdeseng.com/labs/ocp/ipi/openshift-4.7-aws/>OpenShift 4.7 on AWS</a></li>
</ul>
</li>
<li class=has-sub-menu><a href=https://pages.sysdeseng.com/labs/ocp/upi/>User Provisioned Infrastructure (UPI)<span class="mark closed">+</span></a>
<ul class=sub-menu>
<li><a href=https://pages.sysdeseng.com/labs/ocp/upi/sno-upi-baremetal/>Manual SNO on baremetal</a></li>
</ul>
</li>
<li><a href=https://pages.sysdeseng.com/labs/ocp/pull-secret-validator/>Pull Secret Validator tool</a></li>
</ul>
</li>
<li class=has-sub-menu><a href=https://pages.sysdeseng.com/labs/deploy/>Deploy Operators and Resources<span class="mark closed">+</span></a>
<ul class=sub-menu>
<li class=has-sub-menu><a href=https://pages.sysdeseng.com/labs/deploy/operator/>Operator<span class="mark closed">+</span></a>
<ul class=sub-menu>
<li><a href=https://pages.sysdeseng.com/labs/deploy/operator/localstorage/>LocalStorage</a></li>
<li><a href=https://pages.sysdeseng.com/labs/deploy/operator/hive/>Hive</a></li>
<li><a href=https://pages.sysdeseng.com/labs/deploy/operator/assistedinstaller/>Assisted Installer</a></li>
</ul>
</li>
<li class=has-sub-menu><a href=https://pages.sysdeseng.com/labs/deploy/hub-spoke/>Hub & Spoke cluster<span class="mark closed">+</span></a>
<ul class=sub-menu>
<li><a href=https://pages.sysdeseng.com/labs/deploy/hub-spoke/acm/>Using Advanced Cluster Management (ACM)</a></li>
<li><a href=https://pages.sysdeseng.com/labs/deploy/hub-spoke/ai/>Using Assisted Installer (AI)</a></li>
</ul>
</li>
<li class=has-sub-menu><a href=https://pages.sysdeseng.com/labs/deploy/baremetalhost/>BareMetalHost<span class="mark closed">+</span></a>
<ul class=sub-menu>
<li><a href=https://pages.sysdeseng.com/labs/deploy/baremetalhost/virtual-over-acm/>Virtual over ACM</a></li>
<li><a href=https://pages.sysdeseng.com/labs/deploy/baremetalhost/virtual-over-ai/>Virtual over Assisted Installer</a></li>
</ul>
</li>
<li class=has-sub-menu><a href=https://pages.sysdeseng.com/labs/deploy/remoteworkernode/>RemoteWorkerNode<span class="mark closed">+</span></a>
<ul class=sub-menu>
<li><a href=https://pages.sysdeseng.com/labs/deploy/remoteworkernode/day2-spoke-worker/>Day2 with spoke cluster to add worker nodes</a></li>
<li><a href=https://pages.sysdeseng.com/labs/deploy/remoteworkernode/rwn-using-ai-crd/>Day2 with spoke cluster to add worker nodes</a></li>
<li><a href=https://pages.sysdeseng.com/labs/deploy/remoteworkernode/late-binding/>Late Binding adding new agents</a></li>
<li><a href=https://pages.sysdeseng.com/labs/deploy/remoteworkernode/rwn-to-day2-spoke-worker/>Remote Worker Node in Day2 spoke cluster to add worker nodes</a></li>
<li><a href=https://pages.sysdeseng.com/labs/deploy/remoteworkernode/rwn-to-ai-using-aicli-api/>RWN to Assisted Installer using AICLI API</a></li>
</ul>
</li>
<li><a href=https://pages.sysdeseng.com/labs/deploy/sno-acm-spokesno-scripts/>Deploy a Hub SNO with ACM and Spoke SNO on top of it using scripts</a></li>
<li><a href=https://pages.sysdeseng.com/labs/deploy/lab-physical-ipv6disc/>Physical IPv6 Disconnected Lab</a></li>
<li><a href=https://pages.sysdeseng.com/labs/deploy/rhacm/>Red Hat Advanced Cluster Management (ACM)</a></li>
<li><a href=https://pages.sysdeseng.com/labs/deploy/ztp-the-hard-way/>ZTP The Hard Way</a></li>
</ul>
</li>
<li class=has-sub-menu><a href=https://pages.sysdeseng.com/labs/vocabulary/>Vocabularies<span class="mark closed">+</span></a>
<ul class=sub-menu>
<li><a href=https://pages.sysdeseng.com/labs/vocabulary/vocabulary/>Vocabulary</a></li>
</ul>
</li>
</ul>
</nav>
<div class=sidebar-footer></div>
</div>
</div><a href=# id=backtothetop-fixed class=backtothetop data-backtothetop-duration=600 data-backtothetop-easing=easeOutQuart data-backtothetop-fixed-fadein=1000 data-backtothetop-fixed-fadeout=1000 data-backtothetop-fixed-bottom=10 data-backtothetop-fixed-right=20>
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>